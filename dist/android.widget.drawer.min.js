this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.drawer=function(){"use strict";const{NODE_RESOURCE:e}=squared.base.lib.constant,{CONTAINER_NODE:t,SUPPORT_TAGNAME:a,SUPPORT_TAGNAME_X:i}=android.lib.constant,{assignEmptyValue:r,cloneObject:n,iterateArray:o}=squared.lib.util,{createThemeAttribute:s,createViewAttribute:d}=android.lib.util,u=android.base.Resource;class Drawer extends squared.base.ExtensionUI{constructor(e,t,a){super(e,t,a),this.documentBase=!0,this.require({name:"android.external",leading:!0}),this.require({name:"android.widget.menu"}),this.require({name:"android.widget.coordinator"})}beforeInsertNode(e,t){if(this.included(e)){const a=this.application;o(e.children,(e=>{if("NAV"===e.tagName){const t=a.getDatasetName("use",e);Drawer.includes(t,"android.external")||a.setDatasetName("use",e,(t?t+", ":"")+"android.external")}}));const i=a.getProcessing(t).rootElements;return i.includes(e)||i.push(e),!0}return!1}processNode(e,t){const n=d(this.options.self),o=e.localSettings.resourceId;if(Drawer.findNestedElement(e,"android.widget.menu"))r(n,"android","fitsSystemWindows","true"),this.setStyleTheme(o,e.api);else{const t=d(this.options.navigationView);r(t,"android","layout_gravity",e.localizeString("left"));const a=e.item(-1);a.mergeGravity("layout_gravity",t.android.layout_gravity),a.setLayoutHeight("match_parent"),a.positioned=!0}e.documentRoot=!0,e.renderExclude=!1;const s=e.api<29?a.DRAWER:i.DRAWER;return e.setControlType(s,14),e.exclude({resource:4}),e.apply(u.formatOptions(o,n,this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))),e.render(t),e.setLayoutWidth("match_parent"),e.setLayoutHeight("match_parent"),{output:{type:1,node:e,controlName:s},complete:!0,include:!0,remove:!0}}afterParseDocument(e){var t,n;for(const o of this.subscribers)if(o.sessionId===e){const e=o.localSettings.systemName,s=d(this.options.navigationView),c=null===(t=Drawer.findNestedElement(o,"android.widget.menu"))||void 0===t?void 0:t.dataset["layoutName"+e],l=null===(n=Drawer.findNestedElement(o,"android.external"))||void 0===n?void 0:n.dataset["layoutName"+e],m=s.app||(s.app={});if(c&&r(m,"menu",`@menu/${c}`),l&&r(m,"headerLayout",`@layout/${l}`),c||l){const e=this.controller;r(s,"android","id",`@+id/${o.controlId}_navigation`),r(s,"android","fitsSystemWindows","true"),r(s,"android","layout_gravity",o.localizeString("left")),e.addAfterInsideTemplate(o,e.renderNodeStatic({controlName:o.api<29?a.NAVIGATION_VIEW:i.NAVIGATION_VIEW,width:"wrap_content",height:"match_parent"},u.formatOptions(o.localSettings.resourceId,s,this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))))}}}postOptimize(e){for(const t of e.ascend())t.hasHeight||t.setLayoutHeight("match_parent")}setStyleTheme(e,t){const a=this.application.userSettings,i=s(this.options.resource);if(r(i,"name",a.manifestThemeName),r(i,"parent",a.manifestParentThemeName),r(i.items,"android:windowTranslucentStatus","true"),u.addTheme(e,i),t>=21){const t=s(n(i)),a={};r(t.output,"path","res/values-v21"),r(a,"android:windowDrawsSystemBarBackgrounds","true"),r(a,"android:statusBarColor","@android:color/transparent"),t.items=a,u.addTheme(e,t)}}}const c=new Drawer("android.widget.drawer",2);return squared&&squared.add(c),c}();
