this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";const{NODE_PROCEDURE:e,NODE_RESOURCE:t}=squared.base.lib.constant,{CONTAINER_NODE:n}=android.lib.constant,{capitalize:a,sameArray:i}=squared.lib.util,{createViewAttribute:r}=android.lib.util,{appendSeparator:o}=squared.base.lib.util,s=android.base.Resource,d={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^\d+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},c={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},l="menu",u="item",m="group",h=["showAsAction","actionViewClass","actionProviderClass"],p="ic_menu_";function g(e,t,n){const a=t.dataset;for(const t in a){const i=e[t];if(i){const e=a[t];if(e){const a=i.exec(e);if(a){const e=h.includes(t)?"app":"android";(n[e]||(n[e]={}))[t]=Array.from(new Set(a)).join("|")}}}}}function f(e,t){const n=t.title.trim();if(n)return n;for(const t of e.naturalChildren)if(t.textElement&&!t.textEmpty)return t.textContent.trim();return""}const b=(e,t)=>!!e.find((e=>e.toElementString("type")===t));class Menu extends squared.base.ExtensionUI{constructor(e,t,n){super(e,t,n),this.cascadeAll=!0,this.require({name:"android.external",leading:!0})}beforeInsertNode(e,t){if(this.included(e)&&e.childElementCount){if(!i(e.children,(e=>e.tagName)))return!1;const n=this.application.getProcessing(t).rootElements;let a=e.parentElement;for(;a;){if("NAV"===a.tagName&&n.includes(a))return!1;a=a.parentElement}return n.includes(e)||n.push(e),!0}return!1}condition(e){return this.included(e.element)}processNode(e,t){const n=this.application.createNode(e.sessionId,{parent:t,flags:1});return n.childIndex=e.childIndex,n.actualParent=t.actualParent,e.documentRoot=!0,e.setControlType(l,11),e.addAlign(2),e.exclude({resource:31,procedure:63}),e.render(n),e.cascade((e=>this.addDescendant(e))),e.dataset["pathname"+a(this.application.systemName)]=o(this.controller.userSettings.outputDirectory,"res/menu"),{outerParent:n,output:{type:1,node:e,controlName:l},complete:!0}}processChild(e,t){if(e.plainText)return e.hide(),{next:!0};const n=r(),a=n.android,i=e.localSettings.resourceId,o=e.element;let h,N;switch("NAV"===e.tagName?(h=l,N=f(e,o)):e.find((e=>!e.isEmpty()))?(e.find((e=>"NAV"===e.tagName))?h=u:(h=m,e.every((e=>b(e,"radio")))?a.checkableBehavior="single":e.every((e=>b(e,"checkbox")))&&(a.checkableBehavior="all")),N=f(e,o)):(h=u,N=(o.title||o.innerText).trim(),b(e,"checkbox")&&!t.android("checkableBehavior")&&(a.checkable="true")),h){case l:e.addAlign(2);break;case m:e.addAlign(2),g(c,o,n);break;case u:if(g(d,o,n),!a.icon){const t=this.resource;let n=t.addImageSrc(i,e.backgroundImage,p);if(n)a.icon=`@drawable/${n}`;else{const r=e.find((e=>e.imageElement));r&&(n=t.addImageSrc(i,r.element,p),n&&(a.icon=`@drawable/${n}`))}}e.each((e=>"NAV"!==e.tagName&&e.hide()))}return N&&(a.title=s.addString(i,N,"",this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))),e.setControlType(h,11),e.exclude({resource:31,procedure:63}),e.render(t),e.apply(n),{output:{type:1,node:e,controlName:h},complete:!0,next:h===l}}}const N=new Menu("android.widget.menu",2,{tagNames:["NAV"]});return squared&&squared.add(N),N}();
